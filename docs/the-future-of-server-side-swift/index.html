<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>The future of server side Swift - The.Swift.Dev.</title>
    
    <meta name="description" content="What's going to happen with Swift on the Server in 2022? Distributed actors, Vapor 5, some predictions and wishes.">
    
    <meta property="og:title" content="The future of server side Swift - The.Swift.Dev.">
    <meta property="og:description" content="What's going to happen with Swift on the Server in 2022? Distributed actors, Vapor 5, some predictions and wishes.">
    <meta property="og:url" content="https://theswiftdev.com/the-future-of-server-side-swift/">
    <meta property="og:image" content="https://theswiftdev.com/images/assets/the-future-of-server-side-swift/cover.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@tiborbodecs">
    <meta name="twitter:creator" content="@tiborbodecs">
    <meta name="twitter:title" content="The future of server side Swift - The.Swift.Dev.">
    <meta name="twitter:description" content="What's going to happen with Swift on the Server in 2022? Distributed actors, Vapor 5, some predictions and wishes.">
    <meta name="twitter:image" content="https://theswiftdev.com/images/assets/the-future-of-server-side-swift/cover.jpg">
    
    <link rel="stylesheet" href="https://theswiftdev.com/css/style.css">
    <link rel="stylesheet" href="https://theswiftdev.com/css/syntax.css">
    
    <link rel="mask-icon" sizes="any" href="https://theswiftdev.com/images/icons/icon.svg">

    <link rel="shortcut icon" href="https://theswiftdev.com/images/icons/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://theswiftdev.com/images/icons/icon-320.png" type="image/png">
    
    <link rel="apple-touch-icon" href="https://theswiftdev.com/images/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="https://theswiftdev.com/images/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://theswiftdev.com/images/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://theswiftdev.com/images/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://theswiftdev.com/images/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://theswiftdev.com/images/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://theswiftdev.com/images/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://theswiftdev.com/images/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://theswiftdev.com/images/icons/apple-touch-icon-180x180.png">
    
</head>

<body>
    <a href="https://theswiftdev.gumroad.com" class="ribbon">
        
    </a>
    <header id="page-header">
        <a href="https://theswiftdev.com/">
            <img 
                id="logo-image"
                src="https://theswiftdev.com/images/icons/icon-320.png"
                alt="Logo of The.Swift.Dev." 
                title="The.Swift.Dev."
            >
        </a>
    </header>
    
    <main>

        <article>
    <header>
        <section id="post-header" class="content-wrapper">
            <time datetime="2022/01/05">2022/01/05</time>
            <h1 class="title">The future of server side Swift</h1>
            <p class="excerpt">What's going to happen with Swift on the Server in 2022? Distributed actors, Vapor 5, some predictions and wishes.</p>
            <div class="meta">
                <span class="tag">Vapor</span>
<span class="tag">Swift</span>
            </div>
        </section>
        <section class="wrapper">
            <img id="post-image" src="https://theswiftdev.com/images/assets/the-future-of-server-side-swift/cover.jpg">
        </section>
    </header>

    <div id="contents">
        <section class="content-wrapper">
            <h2>The new Swift concurrency model</h2><p>One of the greatest thing about Swift 5.5 is definitely the new <a href="https://docs.swift.org/swift-book/LanguageGuide/Concurrency.html" target="_blank">concurrency model</a>, which introduced quite a lot of new features and APIs. The implementation of the <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0296-async-await.md" target="_blank">async / await</a> proposal allows us completely eliminate the need of unnecessary closures and completion handlers. <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0306-actors.md" target="_blank">Actors</a> are great for isolating data, they can prevent data races and protect you from unwanted memory issues too. With the <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0304-structured-concurrency.md" target="_blank">structured concurrency</a> features we're able to define tasks, we can form dependencies between them and they even have built-in cancellation support.</p><p>With these features added we can say that Swift is a great language for writing concurrent code, but what's missing? Well, of course there is always room for improvements and in this case I have some features that I'd love to see coming to Swift. </p><p>For example currently there is no way to define an executor object for an actor. This would be a great addition for SwiftNIO and many more server side related projects, because it'd heavily reduce the overhead of context switching. An actor with a <a href="https://forums.swift.org/t/support-custom-executors-in-swift-concurrency/44425" target="_blank">custom executor</a> could have an event loop and this way it would be possible to ensure that all the future calls are tied to the exact same event loop.</p><p>The other thing I'd like to mention is called <a href="https://www.swift.org/blog/distributed-actors/" target="_blank">distributed actors</a>, this feature is definitely going to come to Swift in the near future. Distributed actors allow developers to scale their programs beyond a single process or node, this means that your code can run on multiple processes or even multiple machines by taking advantage of <a href="https://en.wikipedia.org/wiki/Location_transparency" target="_blank">location transparency</a>. Honestly, I don't know much about distributed actors yet, but I can imagine that this is going to be a game-changer feature. </p><p>I know this is just the beginning of a new era, but still the new concurrency model change quite a lot about how we build our programs. Async / await is extremely powerful and as we move forward and learn more about actors our Swift apps will get even better, through the built-in safety features that they provide. Building reliable apps is a must and I really like this direction that we're heading.</p><h2>On the road to Vapor 5</h2><p>Vapor 4 is amazing, but what are the next steps for the web framework? You can find out a little bit more about the future of Vapor by joining the <a href="https://discord.com/invite/vapor" target="_blank">official discord server</a>, there is a vapor-5 channel where people already started to throw in ideas about the next major release.</p><p>Personally, I'd like to see some minor changes about Vapor, but I'd like to see a major API redesign for Fluent. Currently Fluent Models are working like repositories and they also provide the structural definition for the database schemas. Sorry to say, but I hate this approach. I believe that the schema definition should be completely separated from the queried models. For example:</p><pre><code class="language-swift"><span class="keyword">import</span> Vapor
<span class="keyword">import</span> Fluent

<span class="keyword">struct</span> TodoCreate: <span class="type">Codable</span> {
    <span class="keyword">let</span> name: <span class="type">String</span>
    <span class="keyword">let</span> isCompleted: <span class="type">Bool</span>
}

<span class="keyword">struct</span> TodoList: <span class="type">Codable</span> {
    <span class="keyword">let</span> id: <span class="type">UUID</span>
    <span class="keyword">let</span> name: <span class="type">String</span>
    <span class="keyword">let</span> isCompleted: <span class="type">Bool</span>
}

<span class="keyword">struct</span> TodoSchema: <span class="type">DatabaseSchema</span> {

    <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"todos"</span>

    <span class="keyword">var</span> definition = <span class="type">Definition</span> {
        <span class="type">Migration</span>(id: <span class="string">"v1"</span>) {
            <span class="type">Process</span> {
                <span class="type">CreateSchema</span>(name) {
                    <span class="type">Field</span>(type: .<span class="dotAccess">id</span>)
                    <span class="type">Field</span>(type: .<span class="dotAccess">string</span>, .<span class="dotAccess">required</span>, key: <span class="string">"name"</span>)
                    <span class="type">Field</span>(type: .<span class="dotAccess">bool</span>, .<span class="dotAccess">required</span>, key: <span class="string">"isComplete"</span>)
                    <span class="comment">// Unique(on: "title")</span>
                }
            }
            <span class="type">Revert</span> {
                <span class="type">DeleteSchema</span>(name)
            }
        }
        <span class="type">Migration</span>(id: <span class="string">"seed"</span>) {
            <span class="type">Process</span> {
                <span class="type">CreateRecords</span>(schema: name) {
                    <span class="type">TodoCreate</span>(name: <span class="string">"foo"</span>, isComplete: <span class="keyword">true</span>)
                }
            }
            <span class="type">Revert</span> {
                <span class="type">DeleteRecords</span>(schema: name)
            }
        }
    }
}

<span class="keyword">struct</span> TodoRepository: <span class="type">DatabaseRepository</span> {
    <span class="keyword">typealias</span> Create = <span class="type">TodoCreate</span>
    <span class="keyword">typealias</span> List = <span class="type">TodoList</span>
}

<span class="keyword">extension</span> <span class="type">TodoList</span>: <span class="type">Content</span> {}

<span class="keyword">func</span> someAsyncRequestHandler(<span class="keyword">_</span> req: <span class="type">Request</span>) <span class="keyword">async throws</span> -&gt; [<span class="type">TodoList</span>] {
    <span class="keyword">let</span> object = <span class="type">TodoCreate</span>(name: <span class="string">"bar"</span>, isCompleted: <span class="keyword">false</span>)
    <span class="keyword">try await</span> <span class="type">TodoRepository</span>.<span class="call">create</span>(object, on: req.<span class="property">db</span>) 
    <span class="keyword">return try await</span> <span class="type">TodoRepository</span>.<span class="call">findAll</span>(on: req.<span class="property">db</span>) 
}</code></pre><p>As you can see instead of mixing up the Model definition with migration related info this way the schema definition could have its own place and the database repository could take care of all the querying and record alteration features. It would be nice to have a DSL-like approach for migrations, since I don't see any benefits of passing around that stupid database pointer. </p><p>Maybe you think, hey you're crazy this idea is stupid, but still my real-world experience is that I need something like this in the future, so yeah, hopefully the core team will see this post and get some inspiration for their future work. Maybe it's too late and they don't want to include such drastic changes, but who knows, I can still hope &amp; wish for such things, right?</p><p>My other secret wish is the ability to dynamically reset a Vapor app, because in order to enable and disable a module I'd have to remove all the registered routes, middlewares, commands and migrations from the system. Currently this is just partially possible, but I really hope that the core team will provide some kind of open API that'd let me do this.</p><pre><code class="language-swift"><span class="keyword">import</span> Vapor

<span class="keyword">public extension</span> <span class="type">Application</span> {
    <span class="keyword">func</span> reset() {
        app.<span class="property">middleware</span>.<span class="property">storage</span> = []
        app.<span class="property">routes</span>.<span class="property">all</span> = []
        app.<span class="property">migrations</span>.<span class="property">storage</span> = [:]
        app.<span class="property">commands</span>.<span class="property">commands</span> = [:]
    }
}

<span class="keyword">try</span> app.<span class="call">reset</span>()</code></pre><p>If this was possible I could load a dylib and provide a proper install, update, delete mechanism through a module manager. This would allow Feather CMS to open a module store and install extensions with just a single click, that'd be HUGE, so please give me this API. </p><p>Anyway, these are just my wishes, Vapor 5 will be a great release I'm quite sure about that, one more additional thing is that I'd like to see is to reduce the size of the core library (opt-out from websockets, console and multipart libs?, merge async-kit with the core?), it'd be nice to completely drop event loop future based APIs and drop the Async* prefixes. That's all I'd like to see.</p><h2>Feather CMS</h2><p>So, after a bit more than one and a half year of development, now I'm getting ready to release an actual version of my content management system. I've had several ups and downs, personal issues during this period of time, but I never stopped thinking about Feather. </p><p>The main idea and purpose is to provide a reliable type-safe modular CMS, written entirely in Swift. The long term goal is to build a dynamic module system, just like the Wordpress plugin ecosystem and I'd be able to install and remove components with just a single click, without the need of recompiling the code. This is why I've researched so much about dylibs and frameworks. This is the reason why I'm using hook functions and why I'm trying to encapsulate everything inside a module. The good news is that modules will have public API libraries so the server side code can be shared with clients (mostly iOS, but the API code can be easily converted into another languages).</p><h3>What are the problems that Feather tries to solve?</h3><ul><li>There is no easy to use backend (API) system for mobile apps.</li><li>Building admin interfaces on top of a set of APIs is a pain in the ass.</li><li>API definitions are not shared with the client at all (leads to issues)</li><li>Backend developers don't update API docs properly (or they don't write it at all)</li><li>There is no API / CMS with proper user permission &amp; role management</li><li>Swift is resource (low memory footprint) and cost effective on the server</li></ul><p>Hopefully with Feather I'll be able to tackle a few of these issues from the list. Please remember, that this is just my point of view, of course there are many great examples out there and I've seen properly written systems using node.js, golang or PHP. I don't mind using other technologies, I'm a heavy Wordpress user and I like JavaScript too, but I can also see the potential in Swift. </p><p>I'd love to see a future where more and more people could use backends written in Swift, maybe even using Feather CMS. I know that changing things will take time and I also know that people don't like changes, but I really hope that they'll realize the importance of Swift.</p><p>We are living in a world where resources are limited and by using a more efficient language we could lower our ecological footprint. With the current chip shortage, we should really thik about this. The M1 CPU and Swift could take over the servers and we could drastically reduce the cost that we have to pay for our backend infrastructures. In 10 years I really wish to look back to this period of time as the beginning of the server side Swift era, but who knows, we'll see. </p>
        </section>
    </div>

</article>

<section id="share" class="content-wrapper">
    <p>
    <a
        href="https://x.com/intent/tweet?via=tiborbodecs&amp;hashtags=SwiftLang&amp;url=https://theswiftdev.com/the-future-of-server-side-swift/"
        target="_blank"
    >
        Share this article
    </a>
    <br> Thank you. </p>
</section>

<section  class="wrapper">
    <div id="book">
        <div class="column left">
            <img src="https://theswiftdev.com/images/practical-server-side-swift-cover.png">
        </div>
        <div class="column right">
            <h3>Get the Practical Server Side Swift book</h3>
            <p>Swift on the server is an amazing new opportunity to build fast, safe and scalable backend apps. Write your very first web-based application by using your favorite programming language. Learn how to build a modular blog engine using the latest version of the Vapor 4 framework. This book will help you to design and create modern APIs that'll allow you to share code between the server side and iOS. Start becoming a full-stack Swift developer.</p>
            <a class="button" href="https://gumroad.com/l/practical-server-side-swift" target="_blank">Available on Gumroad</a>
        </div>
    </div>
</section>

<section id="author" class="content-wrapper">
    <img 
        id="author-image"
        src="https://theswiftdev.com/images/profiles/tiborbodecs.jpg"
        alt="Picture of Tibor B枚decs" 
        title="Tibor B枚decs"
    >
    <h3>Tibor B枚decs</h3>
    <p class="title">CEO @ <a href="https://binarybirds.com/">Binary Birds</a></p>
    <p class="bio">Server side Swift enthusiast, book author, content creator.</p>

    <div class="links">
        <a href="mailto:mail.tib@gmail.com?subject=theswiftdev.com" target="_blank">Email</a> 路 
        <a href="https://x.com/tiborbodecs" target="_blank">X</a> 路 
        <a href="https://github.com/tib" target="_blank">GitHub</a> 
    </div>
</section>

        
    </main>

    <footer>
        <section class="content-wrapper">
            <img 
                src="https://theswiftdev.com/images/icons/icon-320.png"
                alt="Logo of The.Swift.Dev." 
                title="The.Swift.Dev."
            >

            <p>This site was generated using the <a href="https://swift.org/" target="_blank">Swift</a> programming language.</p>
            
            <p> 
                <a href="https://theswiftdev.com/">Home</a> 路
                <a href="https://theswiftdev.com/rss.xml" target="_blank">RSS</a> 路
                <a href="https://theswiftdev.com/sitemap.xml" target="_blank">Sitemap</a>
            </p>
            
            <p class="small">Created by Tibor B枚decs &copy; 2015 - 2023.</p>
        </section>
    </footer>
</body>
</html>
